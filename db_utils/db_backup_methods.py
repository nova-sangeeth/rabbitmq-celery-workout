import time
import os
import subprocess



def backup_postgres_db(host, database_name, port, user, password, dest_file, table_only, schema):
    process = subprocess.Popen(
        [
            "pg_dump",
            # "--data-only",
            "--table=acl",
            "--table=acl_rules"
            "--table=actions",
            "--table=action_types",
            "--table=alert_types",
            "--table=benefit_types",
            "--table=candidate_level_speciality",
            "--table=candidate_levels",
            "--table=candidate_types",
            "--table=contact_types",
            "--table=country_info",
            "--table=currencies",
            "--table=customer_admin_types",
            "--table=customer_type",
            "--table=customer_user_types",
            "--table=departments",
            "--table=display_data",
            "--table=display_types",
            "--table=districts",
            "--table=divergents",
            "--table=document_ext",
            "--table=document_owner",
            "--table=document_type_ext",
            "--table=document_types",
            "--table=entities",
            "--table=filters",
            "--table=gender",
            "--table=issue_authorities",
            "--table=issue_authority_candidate_type",
            "--table=issue_authority_qual",
            "--table=issue_authority_type",
            "--table=job_candidate_process_action",
            "--table=job_candidate_process_actions",
            "--table=job_candidate_process",
            "--table=job_detail_type",
            "--table=job_types",
            "--table=keyword_most_frequent_word",
            "--table=language_proficiency",
            "--table=languages",
            "--table=locations",
            "--table=marital_status",
            "--table=non_medical_qual_type",
            "--table=non_medical_qual",
            "--table=organisation_types",
            "--table=pqr_ahp_detail",
            "--table=pqr_detail",
            "--table=pqr_header",
            "--table=qualification_classification",
            "--table=qualifications",
            "--table=reason_types",
            "--table=reasons",
            "--table=recruitment_types",
            "--table=region_countries",
            "--table=regions",
            "--table=role_types",
            "--table=skill_types",
            "--table=skills",
            "--table=special_interest",
            "--table=speciality_department",
            "--table=speciality_lookup",
            "--table=speciality_sub_speciality_self_reference_types",
            "--table=speciality_sub_speciality_self_references",
            "--table=speciality_types",
            "--table=speciality",
            "--table=status_types",
            "--table=status",
            "--table=sub_speciality",
            "--table=tabs",
            "--table=team_levels",
            "--table=titles",
            "--dbname=postgresql://{}:{}@{}:{}/{}".format(user, password, host, port, database_name),
            # "-Fc",
            '-f', dest_file,
            '-v'
        ],
        stdout=subprocess.PIPE,
    )
    output = process.communicate()
    return output


backup_postgres_db(
        database_name="app",
        dest_file=f'reference_data_1.sql',
        host='localhost',
        password='postgres',
        port=5432,
        user='postgres',
        table_only=True,
        schema="reference_data"
    )